function changeSize(e,t,n){for(var o,i=0;3>i;i++)o=document.querySelector("#size"+i),o.className=i==n?"active":"";document.getElementById(currentPlayerId).style.width=e,document.getElementById(currentPlayerId).style.height=t}function changeOptions(e){var t=document.querySelector("#"+currentPlayerId);t&&(t.innerHTML="");for(var n,o=0;2>o;o++)n=document.querySelector("#test"+o),n.className=o==e?"active":"";switch(kkplayer&&kkplayer.destroy(),e){case 0:kkplayer=new KKPlayer.create("KKPlayerDemo",opt0);break;case 1:kkplayer=new KKPlayer.create("KKPlayerDemo",opt1)}}function toggleSkin(){var e=document.getElementById("skin");0===a?(e.setAttribute("href","./player/skin-stone.css"),a=1):1===a&&(e.setAttribute("href","./player/skin-sky.css"),a=0)}var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},KKPlayer;!function(e){var t=function(){function e(){this.isObject=this._isType("object"),this.isFunction=this._isType("function"),this.isString=this._isType("string"),this.isNumber=this._isType("number"),this.isBoolean=this._isType("boolean"),this.isArray=Array.isArray||this._instanceOf(Array)}return e.prototype._isType=function(e){return function(t){return typeof t===e}},e.prototype._instanceOf=function(e){return function(t){return t instanceof e}},e.prototype.q=function(e,t){return(t||document).querySelector(e)},e.prototype.all=function(e,t){return(t||document).querySelectorAll(e)},e.prototype.addClass=function(e,t,n){return this.q(e,n).classList.add(t)},e.prototype.removeClass=function(e,t,n){return this.q(e,n).classList.remove(t)},e.prototype.toggleClass=function(e,t,n){return this.q(e,n).classList.toggle(t)},e}();e.jQlite=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){e.QS=new e.jQlite}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function e(){this._listeners=[]}return e.prototype.hasEventListener=function(e,t){for(var n=0;n<this._listeners.length;n++)if(this._listeners[n].type===e&&this._listeners[n].listener===t)return!0;return!1},e.prototype.addEventListener=function(e,t,n){this.hasEventListener(e,t)||this._listeners.push({type:e,listener:t})},e.prototype.dispatchEvent=function(e){for(var t=0;t<this._listeners.length;t++)if(this._listeners[t].type===e.type)return this._listeners[t].listener.call(this,e),!0;return!1},e.prototype.removeEventListener=function(e,t,n){for(var o=0;o<this._listeners.length;o++)if(this._listeners[o].type===e&&this._listeners[o].listener===t){this._listeners.splice(o,1);break}},e.prototype.removeAllEventListener=function(){this._listeners=[]},e}();e.EventDispatcher=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(t){function n(e,n){t.call(this),this.eventArray=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","readystatechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.videoEle=e,this.initVideoElement(e,n),this.initEventListener()}return __extends(n,t),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this.videoEle?this.videoEle.currentTime:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.videoEle?this.videoEle.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"progress",{get:function(){return this.videoEle?this.videoEle.currentTime/this.videoEle.duration:0},enumerable:!0,configurable:!0}),n.prototype.on=function(e){var t=!1,n=new Event(e.type);switch(e.type){case"loadstart":case"progress":case"canplay":case"suspend":case"loadeddata":break;case"playing":case"pause":case"seeking":case"seeked":case"stalled":case"waiting":case"timeupdate":t=!0}n&&this.dispatchEvent(n)},n.prototype.getBufferedPercent=function(){var e,t,n=this.videoEle.buffered,o=this.duration,i=0;if(!o)return 0;for(var r=0;r<n.length;r++)e=n.start(r),t=n.end(r),t>o&&(t=o),i+=t-e;return console.log(i),i/o},n.prototype.initVideoElement=function(t,n){if(!t.innerHTML){t.autoplay=!!e.KKOptions.autoPlay||!1,t.loop=!!e.KKOptions.loop||!1,t.muted=!!e.KKOptions.muted||!1,t.poster=e.KKOptions.poster||"",t.preload=e.KKOptions.preload?"true":"auto",this.videoEle.timeToHideControl=e.KKOptions.timeToHideControl||0,e.QS.isString(e.KKOptions.src)?this.videoEle.src=e.KKOptions.src:e.QS.isArray(e.KKOptions.src)&&e.KKOptions.src.map(function(e){var n=document.createElement("source");n.src=e,t.appendChild(n)});var o=document.createElement("p");o.innerHTML="Your browser does not support the <code>video</code> element.",this.videoEle.appendChild(o)}},n.prototype.initEventListener=function(){var e=this;this.eventArray.map(function(t){e.videoEle.addEventListener(t,e.on.bind(e),!1)})},n.prototype.play=function(){this.videoEle.play()},n.prototype.pause=function(){this.videoEle.pause()},Object.defineProperty(n.prototype,"paused",{get:function(){return this.videoEle.paused},enumerable:!0,configurable:!0}),n.prototype.mute=function(){this.videoEle.muted=!0;var e=new Event("onMute");this.dispatchEvent(e)},n.prototype.unmute=function(){this.videoEle.muted=!1;var e=new Event("onUnmute");this.dispatchEvent(e)},Object.defineProperty(n.prototype,"muted",{get:function(){return this.videoEle.muted},enumerable:!0,configurable:!0}),n.prototype.togglePlay=function(){this.paused?this.play():this.pause()},n.prototype.toggleMute=function(){this.muted?this.unmute():this.mute()},n.prototype.fullScreen=function(){this.videoEle.requestFullscreen?this.videoEle.requestFullscreen():this.videoEle.msRequestFullscreen?this.videoEle.msRequestFullscreen():this.videoEle.mozRequestFullScreen?this.videoEle.mozRequestFullScreen():this.videoEle.webkitRequestFullscreen&&this.videoEle.webkitRequestFullscreen()},n.prototype.cancelFullScreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},n.prototype.toggleFullScreen=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?this.cancelFullScreen():this.fullScreen()},n.prototype.seek=function(e){this.videoEle.currentTime=e,this.play()},Object.defineProperty(n.prototype,"volume",{get:function(){return this.videoEle.volume},set:function(e){this.videoEle.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPhone",{get:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){var e=this;this.videoEle.pause(),this.videoEle.src="",t.prototype.removeAllEventListener.call(this),this.eventArray.map(function(t){e.videoEle.removeEventListener(t,e.on.bind(this),!1)})},n}(e.EventDispatcher);e.Video=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function e(e,t,n){var o=document.createElement("button");o.className="kkplayer-play-control kkplayer-icon-play",e.appendChild(o),o.onclick=function(){t.togglePlay()}}return e}();e.PlayBtn=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(t,n,o){this.options=o,this.video=n,this.ele=t;var i=document.createElement("div");i.className="kkplayer-volume-control",t.appendChild(i),i.innerHTML='<button class="kkplayer-volume-btn kkplayer-icon-volume"></button><div class="volume-panel"><div class="volume-bar"><div class="volume-track"><div class="volume-progress kkplayer-icon-circle"></div>',this.muteBtn=e.QS.q(".kkplayer-volume-btn",t),this.volumeBar=e.QS.q(".volume-bar",t),this.volumeEle=e.QS.q(".volume-progress",t),n.addEventListener("onMute",this.onMute.bind(this)),n.addEventListener("onUnmute",this.onUnMute.bind(this)),this.muteBtn.onclick=this.toggleMute.bind(this),this.volumeBar.addEventListener("mousedown",this.onMouseDown.bind(this)),this.volumeBar.addEventListener("touchdown",this.onMouseDown.bind(this)),this.video.addEventListener("volumechange",this.onVolumechange.bind(this))}return t.prototype.onMouseDown=function(e){function t(e){var t=(e.clientX-o.volumeBar.getBoundingClientRect().left)/o.volumeBar.offsetWidth;o.updateVolume(t)}function n(e){document.removeEventListener("mousemove",t),document.removeEventListener("touchmove",t),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n)}var o=this;t(e),document.addEventListener("mousemove",t),document.addEventListener("touchmove",t),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},t.prototype.updateVolume=function(e){e=e>1?1:e,e=0>e?0:e,console.log("updateVolume=",e),this.video.volume=e,0===e?this.onMute():this.onUnMute()},t.prototype.onVolumechange=function(e){this.volumeEle.style.width=100*this.video.volume+"%"},t.prototype.onMute=function(e){this.muteBtn.className="kkplayer-volume-btn kkplayer-icon-muted"},t.prototype.onUnMute=function(e){this.muteBtn.className="kkplayer-volume-btn kkplayer-icon-volume"},t.prototype.toggleMute=function(){this.video.muted?this.video.volume=this.reVolume:(this.reVolume=this.video.volume,this.video.volume=0),this.video.toggleMute()},t}();e.VolumeController=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(t,n,o){this.options=o,this.video=n,this.ele=t;var i=document.createElement("div");i.className="kkplayer-progress-control",t.appendChild(i),i.innerHTML='<div class="progress-bar"><div class="load-progress"></div><div class="preload-progress"></div><div class="loaded-progress kkplayer-icon-circle"></div></div><div class="label-time"><span class="current-time">00:00</span><span class="remain-time">00:00</span></div>',this.videoEle=e.QS.q(".kkplayer"),this.controls=e.QS.q(".kkplayer-controls"),this.controlsBar=e.QS.q(".kkplayer-progress-control"),this.progressHandle=e.QS.q(".progress-bar",t),this.progressLoaded=e.QS.q(".loaded-progress",t),this.displayTime=e.QS.q(".display-time",t),this.currentTime=e.QS.q(".current-time",t),this.cursorTime=e.QS.q(".cursor-time",t),this.remainTime=e.QS.q(".remain-time",t),this.isNeedPause=!1,this.progressHandle.addEventListener("mousedown",this.onMouseDown.bind(this)),this.progressHandle.addEventListener("touchstart",this.onMouseDown.bind(this)),this.controlsBar.addEventListener("touchmove",this.onMouseDown.bind(this)),this.video.addEventListener("mouseup",this.onMouseDown.bind(this)),this.video.addEventListener("touchend",this.onMouseDown.bind(this))}return t.prototype.onMouseDown=function(e){function t(e){var t=e.clientX||e.pageX||e.targetTouches[0].pageX,n=o.progressHandle.getBoundingClientRect().left,i=(t-n)/o.progressHandle.offsetWidth;o.updateProgress(i)}function n(e){document.removeEventListener("mousemove",t),document.removeEventListener("touchmove",t),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n),o.video.isPhone&&i>0&&(clearTimeout(o.timer),o.timer=setTimeout(function(){o.video.paused||(o.controls.classList.add("hideControls"),o.isNeedPause=!1)},i))}var o=this;t(e);var i=1e3*o.video.videoEle.timeToHideControl;document.addEventListener("mousemove",t),document.addEventListener("touchmove",t),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},t.prototype.updateProgress=function(e){var t=this;e=e>1?1:e,e=0>e?0:e;var n=e*t.video.duration;t.video.seek(n),this.progressLoaded.style.width=100*e+"%"},t.prototype.onTimeUpdate=function(e){var t=this;this.progressLoaded.style.width=100*t.video.progress+"%";var n=Math.ceil(t.video.duration),o=Math.ceil(t.video.currentTime);t.remainTime.innerHTML=t.fix(Math.floor(n/60),2)+":"+t.fix(n%60,2),t.currentTime.innerHTML=t.fix(Math.floor(o/60),2)+":"+t.fix(o%60,2)},t.prototype.fix=function(e,t){return(""+e).length<t?(new Array(t+1).join("0")+e).slice(-t):""+e},t}();e.ProgressController=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(t,n,o){var i=document.createElement("button");i.className="kkplayer-fullscreen-control kkplayer-icon-fullscreen-enter",t.appendChild(i),this.video=n,this.videoEle=e.QS.q(".kkplayer"),this.fullScreenBtn=i,this.setFullScreen()}return t.prototype.setFullScreen=function(){var e=this;e.fullScreenBtn.onclick=function(){e.video.isPhone?-1!==e.videoEle.className.indexOf("mobileFullScreen")?(e.videoEle.className="kkplayer",e.fullScreenBtn.className="kkplayer-fullscreen-control kkplayer-icon-fullscreen-enter"):(e.videoEle.className="kkplayer mobileFullScreen",e.fullScreenBtn.className="kkplayer-fullscreen-control kkplayer-icon-fullscreen-exit"):(e.video.toggleFullScreen(),-1!==e.videoEle.className.indexOf("pcFullScreen")?e.videoEle.className="kkplayer":e.videoEle.className="kkplayer pcFullScreen")},document.addEventListener("webkitfullscreenchange",this.onFullscreenChange.bind(this),!1),document.addEventListener("mozfullscreenchange",this.onFullscreenChange.bind(this),!1),document.addEventListener("msfullscreenchange",this.onFullscreenChange.bind(this),!1),document.addEventListener("fullscreenchange",this.onFullscreenChange.bind(this),!1)},t.prototype.onFullscreenChange=function(e){var t=this,n=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;n?(t.video.isPhone?t.videoEle.className="kkplayer mobileFullScreen":t.videoEle.className="kkplayer pcFullScreen",t.fullScreenBtn.className="kkplayer-fullscreen-control kkplayer-icon-fullscreen-exit"):(t.videoEle.className="kkplayer",t.fullScreenBtn.className="kkplayer-fullscreen-control kkplayer-icon-fullscreen-enter")},t}();e.FullScreenBtn=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(t,n,o,i){this.options=i,this.video=n,this.ele=t;var r=document.createElement("div");r.className="kkplayer-vcontrol kkplayer-icon-play",t.appendChild(r),this.vbutton=r,this.videoEle=e.QS.q(".kkplayer"),this.playBtn=e.QS.q(".kkplayer-play-control"),this.controls=e.QS.q(".kkplayer-controls"),this.progressLoaded=e.QS.q(".loaded-progress"),this.currentTime=e.QS.q(".current-time"),this.remainTime=e.QS.q(".remain-time");var s=this;this.addEvent(),this.vbutton.onclick=function(){n.isPhone||n.togglePlay()};var l,a,c=1e3*s.video.videoEle.timeToHideControl;this.videoEle.addEventListener("mousemove",function(e){n.isPhone||(clearTimeout(l),console.log("mousemove"),s.controls.classList.remove("hideControls"),l=setTimeout(function(){!n.paused&&c>0&&(console.log("hideControls"),s.controls.classList.add("hideControls"))},c))}),this.vbutton.addEventListener("touchend",function(e){clearTimeout(l),n.paused?(n.play(),s.vbutton.style.opacity="0",o.isNeedPause=!1,!n.paused&&c>0&&(l=setTimeout(function(){s.controls.classList.add("hideControls"),s.vbutton.style.opacity="0",o.isNeedPause=!1},c))):n.paused||o.isNeedPause?!n.paused&&o.isNeedPause&&(o.isNeedPause=!1,n.pause(),s.vbutton.className="kkplayer-vcontrol kkplayer-icon-play"):(o.isNeedPause=!0,s.vbutton.className="kkplayer-vcontrol kkplayer-icon-pause",s.vbutton.style.opacity="1",!n.paused&&c>0&&(s.controls.classList.remove("hideControls"),l=setTimeout(function(){!n.paused&&s.vbutton.className.indexOf("spinner")<0&&(s.controls.classList.add("hideControls"),s.vbutton.style.opacity="0",o.isNeedPause=!1)},c)))}),n.addEventListener("play",function(e){s.playBtn.classList.add("kkplayer-icon-pause"),s.playBtn.classList.remove("kkplayer-icon-play"),s.vbutton.className="kkplayer-vcontrol",s.vbutton.style.opacity="0",c>0&&(clearTimeout(a),a=setTimeout(function(){s.controls.classList.add("hideControls")},c))}),n.addEventListener("pause",function(e){s.playBtn.classList.add("kkplayer-icon-play"),s.playBtn.classList.remove("kkplayer-icon-pause"),s.vbutton.className="kkplayer-vcontrol kkplayer-icon-play",s.vbutton.style.opacity="1",s.controls.className="kkplayer-controls",s.controls.classList.remove("hideControls")})}return t.prototype.addEvent=function(){var e=this;e.video.addEventListener("waiting",this.setVbutton.bind(this,"1","spinner")),e.video.addEventListener("seeking",this.setVbutton.bind(this,"1","spinner")),e.video.addEventListener("seeked",this.setVbutton.bind(this,"0","spinner")),e.video.addEventListener("ended",this.setVbutton.bind(this,"1","replay")),e.video.addEventListener("timeupdate",this.onTimeUpdate.bind(this))},t.prototype.setVbutton=function(e,t){this.vbutton.style.opacity=e,t?this.vbutton.className="kkplayer-vcontrol kkplayer-icon-"+t:this.vbutton.className="kkplayer-vcontrol"},t.prototype.onTimeUpdate=function(e){var t=this;t.progressLoaded.style.width=100*t.video.progress+"%";var n=Math.ceil(t.video.duration),o=Math.ceil(t.video.currentTime);t.remainTime.innerHTML=t.fix(Math.floor(n/60),2)+":"+t.fix(n%60,2),t.currentTime.innerHTML=t.fix(Math.floor(o/60),2)+":"+t.fix(o%60,2),"1"===t.vbutton.style.opacity&&t.vbutton.classList.contains("kkplayer-icon-spinner")&&(t.vbutton.style.opacity="0")},t.prototype.fix=function(e,t){return(""+e).length<t?(new Array(t+1).join("0")+e).slice(-t):""+e},t}();e.VController=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(t,n,o){this.playBtn=e.QS.q(".kkplayer-play-control",t),this.vbutton=e.QS.q(".kkplayer-vcontrol")}return t}();e.EventController=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(){function t(e,t,n){this.kkvideo=t,this.initControls(e,n)}return t.prototype.controls=function(){},t.prototype.toggleControls=function(){},t.prototype.destroy=function(){},t.prototype.initControls=function(t,n){var o=document.createElement("div");if(o.className="kkplayer-controls",this.kkvideo.isPhone&&(o.className="kkplayer-controls kkplayer-controls-mobile"),t.appendChild(o),!this.kkvideo.isPhone){new e.PlayBtn(o,this.kkvideo,n),new e.VolumeController(o,this.kkvideo,n)}var i=new e.ProgressController(o,this.kkvideo,n),r=(new e.FullScreenBtn(o,this.kkvideo,n),document.createElement("div"));r.className="kkplayer-vcontrols",t.appendChild(r);new e.VController(r,this.kkvideo,i,n);new e.EventController(o,this.kkvideo,n)},t}();e.Controls=t}(KKPlayer||(KKPlayer={}));var KKPlayer;!function(e){var t=function(t){function n(n,o){if(t.call(this),this._id=n,e.KKOptions=this._options=o,!this._id)throw"KKPlayer need id";this.init()}return __extends(n,t),n.prototype.init=function(){this.playerEle=e.QS.q("#"+this._id),this._options.playerEle=this.playerEle;var t,n;this.playerEle.innerHTML&&(t=e.QS.q("#"+this._id+" video"),n=e.QS.q("#"+this._id+" div")),t||(t=this.createVideoEle()),n||(n=this.createControlsEle()),this._video=new e.Video(t,this._options),this._controls=new e.Controls(n,this._video,this._options)},n.prototype.createVideoEle=function(){var e=document.createElement("video");return e.setAttribute("webkit-playsinline","true"),this.playerEle.appendChild(e),e},n.prototype.createControlsEle=function(){var e=document.createElement("div");return e.className="kkplayer-kkcontrols",this.playerEle.appendChild(e),e},n.prototype.destroy=function(){this._video.destroy(),this._controls.destroy()},n}(e.EventDispatcher);e.create=t}(KKPlayer||(KKPlayer={}));var currentPlayerId="KKPlayerDemo",ipad="http://images.apple.com/media/cn/ipad-pro/2016/8242d954_d694_42b8_b6b7_a871bba6ed54/films/feature/ipadpro-9-7inch-feature-cn-20160321_1280x720h.mp4",teambition="https://dn-site.oss.aliyuncs.com/videos%2F60s_go_to_work.mp4?response-content-type=video/mp4",opt0={autoPlay:!1,timeToHideControl:2,loop:!1,muted:!1,poster:"http://7xni6e.com1.z0.glb.clouddn.com/ipad.png",preload:!1,src:[ipad]},opt1={autoPlay:!1,timeToHideControl:0,loop:!1,muted:!1,poster:"https://dn-st.teambition.net/site/v2.0.0/images/index/video-banner-poster.png",preload:!1,src:[teambition]},kkplayer;changeOptions(0);var a=0;
